<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Top Up FF Darurat</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
  font-family: sans-serif;
  background: #121212;
  color: #fff;
  display: flex;
  justify-content: center;
  padding: 20px;
}

.container {
  background: #1e1e1e;
  padding: 20px;
  border-radius: 10px;
  width: 100%;
  max-width: 400px;
}

input, select, button {
  width: 100%;
  margin: 10px 0;
  padding: 10px;
  border-radius: 8px;
  border: none;
}

button {
  background-color: #f39c12;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
}

#qrisArea img {
  max-width: 100%;
  margin-top: 15px;
}

  </style>
</head>
<body>
  <div class="container">
    <h1>üî• Top Up Free Fire Darurat</h1>

    <form id="topupForm">
      <input type="text" id="userId" placeholder="Masukkan ID Free Fire" required />
      <input type="text" id="zoneId" placeholder="Masukkan Server (Zone ID)" required />

      <button type="button" onclick="cekAkun()">üîç Cek Akun</button>
      <div id="nicknameResult"></div>

      <select id="nominal" required>
        <option value="">Pilih Nominal</option>
      </select>

      <select id="metode" required>
        <option value="">Metode Pembayaran</option>
        <option value="qris">QRIS</option>
        <option value="briva">BRIVA</option>
        <option value="bca">BCA</option>
      </select>

      <button type="submit">üöÄ Top Up Sekarang</button>
    </form>

    <div id="qrisArea"></div>
  </div>

  <script>
    const apikey = 'APIKEY_KAU_DI_APIGAMES'; // ganti ini

async function cekAkun() {
  const userId = document.getElementById('userId').value;
  const zoneId = document.getElementById('zoneId').value;

  const url = `https://api.apigames.id/v1/cek-username/freefire?apikey=${apikey}&user_id=${userId}&zone_id=${zoneId}`;

  const res = await fetch(url);
  const data = await res.json();

  const nicknameResult = document.getElementById('nicknameResult');
  if (data && data.data && data.data.username) {
    nicknameResult.innerText = `üë§ Nickname: ${data.data.username}`;
    loadProduk();
  } else {
    nicknameResult.innerText = "‚ùå Gagal cek akun!";
  }
}

async function loadProduk() {
  const url = `https://api.apigames.id/v1/produk/game/freefire?apikey=${apikey}`;
  const res = await fetch(url);
  const data = await res.json();

  const nominalSelect = document.getElementById('nominal');
  nominalSelect.innerHTML = '<option value="">Pilih Nominal</option>';

  data.data.forEach(item => {
    nominalSelect.innerHTML += `<option value="${item.item_code}">${item.nama} - Rp${item.price}</option>`;
  });
}

document.getElementById('topupForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const userId = document.getElementById('userId').value;
  const zoneId = document.getElementById('zoneId').value;
  const item = document.getElementById('nominal').value;
  const metode = document.getElementById('metode').value;

  const body = {
    user_id: userId,
    zone_id: zoneId,
    item_code: item,
    payment_method: metode,
    username: "bebas",
    inquiry: true
  };

  const res = await fetch("https://api.apigames.id/v1/order", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": `Bearer ${apikey}`
    },
    body: JSON.stringify(body)
  });

  const data = await res.json();
  if (data && data.data && data.data.qr_url) {
    document.getElementById('qrisArea').innerHTML = `<p>Scan QR untuk bayar:</p><img src="${data.data.qr_url}" />`;
  } else {
    document.getElementById('qrisArea').innerText = "‚ùå Gagal buat order.";
  }
});

  </script>
</body>
</html>
